<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: diy.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: diy.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/*global DIY: true*/

/**
* @namespace
*/
var DIY = (function (w) {
	var jsPath = '',

	composeScriptUrl = function (module) {
		var parts = module.split('.'),
			constructorName = parts.pop();

		parts.shift();

		return jsPath + parts.join('/') + '/' + constructorNameToFileName(constructorName) + '.js';
	},

	constructorNameToFileName = function (name) {
		return name.charAt(0).toLowerCase() + name.substr(1);
	},

	getScript = function (module) {
	    var script = document.createElement('script'),
	    	src = composeScriptUrl.call(this, module);

	    script.setAttribute('type', 'text/javascript');
	    script.setAttribute('src', src);

	    return script;
	},

	isModuleAlreadyLoaded = function (module) {
		var parts = module.split('.'),
			root = w[parts.shift()],
			currentPart,
			i;

		for (i = 0; i &lt; parts.length; i++) {
			currentPart = parts[i];

			if (!root[currentPart]) {
				return false;
			}

			root = root[currentPart];
		}

		return true;
	},

	loadDependencies = function (requires) {
		var i,
			docfrag = document.createDocumentFragment(),
			head = document.getElementsByTagName('head')[0];

		for (i = 0; i &lt; requires.length; i++) {
			if (!isModuleAlreadyLoaded(requires[i])) {
				docfrag.appendChild(getScript.call(this, requires[i]));
			}
		}

		head.appendChild(docfrag);
	},

	/**
	* Define your namespace with this method. &lt;br />
	* NOTE: you need to init the framework first, calling {DYI.init} init() &lt;br />
	* The regular way to define a constructor would be:
	* &lt;pre>
	*	DIY.define('myNameSpace', {}, function () {
	*		var myPrivatevar = 1;
	*
	*		this.myPublicMethod = function () {
	*			return myPrivatevar;
	*		}
	* 	})
	*
	* If the constructor has some dependencies:
	* &lt;pre>
	*	DIY.define('myNameSpace', {
	*		requires: [
	*			'MYAPP.module.myModuleNeeded1',
	*			'MYAPP.module.myModuleNeeded2'
	*		]
	*	}, function () {
	*		var myPrivatevar = 1;
	*
	*		this.myPublicMethod = function () {
	*			return myPrivatevar;
	*		}
	* 	})
	* &lt;/pre>
	* This will load the dependencies, if they were not already loaded, asyncronously
	*
	* If the constructor inherits from anyone else:
	* &lt;pre>
	*	DIY.define('myNameSpace', {
	*		extend: 'MYAPP.module.parentModule'
	*	}, function () {
	*		var myPrivatevar = 1;
	*
	*		this.myPublicMethod = function () {
	*			return myPrivatevar;
	*		}
	* 	})
	* &lt;/pre>
	* This will add one instance of "parentModule" to the prototype of myNameSpace
	* NOTE: In this version the parent namespace should be already loaded.
	*  There not load lazy loading implemented for parent constructors
	* @param {String} namespace
	* @param {Object} config Some configurations for the definition of the constructor
	* @param {Function} config.extend. This parameter is mandatory.
	* 	If you dont need inheritance, just pass null, empty string or undefined.
	* @param {Array} config.requires. Array with the modules which are required.
	* 	If you dont need dependencies, just pass an empty array
	* @param {Function} body. Constructor code
	* @memberof DIY
	*/
	define = function (namespace, config, body) {
		var parts = namespace.split('.'),
			appName = parts[0],
			constructor,
			requires = config.requires;

		if (!w[appName]) {
			w[appName] = {};
		}

		if (requires &amp;&amp; requires.length > 0) {
			loadDependencies.call(this, requires);
		}

		constructor = createNamespace.call(this, w[appName], parts, body, namespace, config.extend);
	},

	findConstructor = function (namespace) {
		var parts = namespace.split('.'),
			root = w[parts.shift()],
			currentPart,
			i;

		for (i = 0; i &lt; parts.length; i++) {
			currentPart = parts[i];

			if (!root[currentPart]) {
				return false;
			}

			root = root[currentPart];
		}

		return root;
	},

	addInheritance = function (child, Parent) {
		var borrowedConstructor = function () {
			Parent.apply(this, arguments);
			child.apply(this, arguments);
		},
		instance = new Parent();
		borrowedConstructor.prototype = instance;
		borrowedConstructor.prototype.parentClass = instance;

		return borrowedConstructor;
	},

	isThereAParentConstructor = function (constructor) {
		return !!constructor;
	},

	createNamespace = function (root, parts, body, namespace, parent) {
		var i,
			length = parts.length,
			current;

		for (i = 1; i &lt; length; i++) {
			current = parts[i];

			if (i &lt; length -  1) {
				if (!root[current]) {
					root[current] = {};
				}
			} else {
				if (root[current]) {
					throw 'The constructor "' + namespace + '" was already defined. Please check.';
				}
				root[current] = getConstructor.call(this, body, parent);
			}

			root = root[current];
		}

		return root;
	},

	getConstructor = function (body, parent) {
		if (isThereAParentConstructor.call(this, parent)) {
			return addInheritance(body, findConstructor.call(this, parent));
		} else {
			return body;
		}
	},

	/**
	* You need to call this method at the beggining of you app with the proper config object
	* 	otherwise you wont be able to use the framework.
	* @param {Object} cfg
	* @param {String} cfg.jsPath Path to the place where your js modules are placed. i.e.
	* &lt;pre>
	* 	jsPath: 'http://localhost/assets/js/src/'
	* &lt;/pre>
	* @memberof DIY
	*/
	init = function (cfg) {
		this.define = define;

		jsPath = cfg.jsPath;
	};

	return {
		define: function () {
			throw 'App not initialized. Please call DIY.init with proper params';
		},
		init: init
	};
})(window);</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Namespaces</h3><ul><li><a href="DIY.html">DIY</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.3</a> on Thu Nov 26 2015 21:12:05 GMT+0100 (Hora est√°ndar romance)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
